// Package soup was automatically generated by github.com/jwijenbergh/puregotk DO NOT EDIT
package soup

import (
	"structs"
	"unsafe"

	"github.com/jwijenbergh/purego"
	"github.com/jwijenbergh/puregotk/pkg/core"
	"github.com/jwijenbergh/puregotk/v4/glib"
	"github.com/jwijenbergh/puregotk/v4/gobject"
	"github.com/jwijenbergh/puregotk/v4/gobject/types"
)

// The class structure for the #SoupWebsocketExtension.
type WebsocketExtensionClass struct {
	_ structs.HostLayout

	ParentClass gobject.ObjectClass

	Name uintptr

	xConfigure uintptr

	xGetRequestParams uintptr

	xGetResponseParams uintptr

	xProcessOutgoingMessage uintptr

	xProcessIncomingMessage uintptr

	Padding [6]uintptr
}

func (x *WebsocketExtensionClass) GoPointer() uintptr {
	return uintptr(unsafe.Pointer(x))
}

// OverrideConfigure sets the "configure" callback function.
// called to configure the extension with the given parameters
func (x *WebsocketExtensionClass) OverrideConfigure(cb func(*WebsocketExtension, WebsocketConnectionType, *glib.HashTable) bool) {
	if cb == nil {
		x.xConfigure = 0
	} else {
		x.xConfigure = purego.NewCallback(func(ExtensionVarp uintptr, ConnectionTypeVarp WebsocketConnectionType, ParamsVarp *glib.HashTable) bool {
			return cb(WebsocketExtensionNewFromInternalPtr(ExtensionVarp), ConnectionTypeVarp, ParamsVarp)
		})
	}
}

// GetConfigure gets the "configure" callback function.
// called to configure the extension with the given parameters
func (x *WebsocketExtensionClass) GetConfigure() func(*WebsocketExtension, WebsocketConnectionType, *glib.HashTable) bool {
	if x.xConfigure == 0 {
		return nil
	}
	var rawCallback func(ExtensionVarp uintptr, ConnectionTypeVarp WebsocketConnectionType, ParamsVarp *glib.HashTable) bool
	purego.RegisterFunc(&rawCallback, x.xConfigure)
	return func(ExtensionVar *WebsocketExtension, ConnectionTypeVar WebsocketConnectionType, ParamsVar *glib.HashTable) bool {
		return rawCallback(ExtensionVar.GoPointer(), ConnectionTypeVar, ParamsVar)
	}
}

// OverrideGetRequestParams sets the "get_request_params" callback function.
// called by the client to build the request header.
//
//	It should include the parameters string starting with ';'
func (x *WebsocketExtensionClass) OverrideGetRequestParams(cb func(*WebsocketExtension) string) {
	if cb == nil {
		x.xGetRequestParams = 0
	} else {
		x.xGetRequestParams = purego.NewCallback(func(ExtensionVarp uintptr) string {
			return cb(WebsocketExtensionNewFromInternalPtr(ExtensionVarp))
		})
	}
}

// GetGetRequestParams gets the "get_request_params" callback function.
// called by the client to build the request header.
//
//	It should include the parameters string starting with ';'
func (x *WebsocketExtensionClass) GetGetRequestParams() func(*WebsocketExtension) string {
	if x.xGetRequestParams == 0 {
		return nil
	}
	var rawCallback func(ExtensionVarp uintptr) string
	purego.RegisterFunc(&rawCallback, x.xGetRequestParams)
	return func(ExtensionVar *WebsocketExtension) string {
		return rawCallback(ExtensionVar.GoPointer())
	}
}

// OverrideGetResponseParams sets the "get_response_params" callback function.
// called by the server to build the response header.
//
//	It should include the parameters string starting with ';'
func (x *WebsocketExtensionClass) OverrideGetResponseParams(cb func(*WebsocketExtension) string) {
	if cb == nil {
		x.xGetResponseParams = 0
	} else {
		x.xGetResponseParams = purego.NewCallback(func(ExtensionVarp uintptr) string {
			return cb(WebsocketExtensionNewFromInternalPtr(ExtensionVarp))
		})
	}
}

// GetGetResponseParams gets the "get_response_params" callback function.
// called by the server to build the response header.
//
//	It should include the parameters string starting with ';'
func (x *WebsocketExtensionClass) GetGetResponseParams() func(*WebsocketExtension) string {
	if x.xGetResponseParams == 0 {
		return nil
	}
	var rawCallback func(ExtensionVarp uintptr) string
	purego.RegisterFunc(&rawCallback, x.xGetResponseParams)
	return func(ExtensionVar *WebsocketExtension) string {
		return rawCallback(ExtensionVar.GoPointer())
	}
}

// OverrideProcessOutgoingMessage sets the "process_outgoing_message" callback function.
// called to process the payload data of a message
//
//	before it's sent. Reserved bits of the header should be changed.
func (x *WebsocketExtensionClass) OverrideProcessOutgoingMessage(cb func(*WebsocketExtension, byte, *glib.Bytes) *glib.Bytes) {
	if cb == nil {
		x.xProcessOutgoingMessage = 0
	} else {
		x.xProcessOutgoingMessage = purego.NewCallback(func(ExtensionVarp uintptr, HeaderVarp byte, PayloadVarp *glib.Bytes) *glib.Bytes {
			return cb(WebsocketExtensionNewFromInternalPtr(ExtensionVarp), HeaderVarp, PayloadVarp)
		})
	}
}

// GetProcessOutgoingMessage gets the "process_outgoing_message" callback function.
// called to process the payload data of a message
//
//	before it's sent. Reserved bits of the header should be changed.
func (x *WebsocketExtensionClass) GetProcessOutgoingMessage() func(*WebsocketExtension, byte, *glib.Bytes) *glib.Bytes {
	if x.xProcessOutgoingMessage == 0 {
		return nil
	}
	var rawCallback func(ExtensionVarp uintptr, HeaderVarp byte, PayloadVarp *glib.Bytes) *glib.Bytes
	purego.RegisterFunc(&rawCallback, x.xProcessOutgoingMessage)
	return func(ExtensionVar *WebsocketExtension, HeaderVar byte, PayloadVar *glib.Bytes) *glib.Bytes {
		return rawCallback(ExtensionVar.GoPointer(), HeaderVar, PayloadVar)
	}
}

// OverrideProcessIncomingMessage sets the "process_incoming_message" callback function.
// called to process the payload data of a message
//
//	after it's received. Reserved bits of the header should be cleared.
func (x *WebsocketExtensionClass) OverrideProcessIncomingMessage(cb func(*WebsocketExtension, byte, *glib.Bytes) *glib.Bytes) {
	if cb == nil {
		x.xProcessIncomingMessage = 0
	} else {
		x.xProcessIncomingMessage = purego.NewCallback(func(ExtensionVarp uintptr, HeaderVarp byte, PayloadVarp *glib.Bytes) *glib.Bytes {
			return cb(WebsocketExtensionNewFromInternalPtr(ExtensionVarp), HeaderVarp, PayloadVarp)
		})
	}
}

// GetProcessIncomingMessage gets the "process_incoming_message" callback function.
// called to process the payload data of a message
//
//	after it's received. Reserved bits of the header should be cleared.
func (x *WebsocketExtensionClass) GetProcessIncomingMessage() func(*WebsocketExtension, byte, *glib.Bytes) *glib.Bytes {
	if x.xProcessIncomingMessage == 0 {
		return nil
	}
	var rawCallback func(ExtensionVarp uintptr, HeaderVarp byte, PayloadVarp *glib.Bytes) *glib.Bytes
	purego.RegisterFunc(&rawCallback, x.xProcessIncomingMessage)
	return func(ExtensionVar *WebsocketExtension, HeaderVar byte, PayloadVar *glib.Bytes) *glib.Bytes {
		return rawCallback(ExtensionVar.GoPointer(), HeaderVar, PayloadVar)
	}
}

// A WebSocket extension
//
// #SoupWebsocketExtension is the base class for WebSocket extension objects.
type WebsocketExtension struct {
	gobject.Object
}

var xWebsocketExtensionGLibType func() types.GType

func WebsocketExtensionGLibType() types.GType {
	return xWebsocketExtensionGLibType()
}

func WebsocketExtensionNewFromInternalPtr(ptr uintptr) *WebsocketExtension {
	cls := &WebsocketExtension{}
	cls.Ptr = ptr
	return cls
}

var xWebsocketExtensionConfigure func(uintptr, WebsocketConnectionType, *glib.HashTable, **glib.Error) bool

// Configures @extension with the given @params.
func (x *WebsocketExtension) Configure(ConnectionTypeVar WebsocketConnectionType, ParamsVar *glib.HashTable) (bool, error) {
	var cerr *glib.Error

	cret := xWebsocketExtensionConfigure(x.GoPointer(), ConnectionTypeVar, ParamsVar, &cerr)
	if cerr == nil {
		return cret, nil
	}
	return cret, cerr

}

var xWebsocketExtensionGetRequestParams func(uintptr) string

// Get the parameters strings to be included in the request header.
//
// If the extension doesn't include any parameter in the request, this function
// returns %NULL.
func (x *WebsocketExtension) GetRequestParams() string {

	cret := xWebsocketExtensionGetRequestParams(x.GoPointer())
	return cret
}

var xWebsocketExtensionGetResponseParams func(uintptr) string

// Get the parameters strings to be included in the response header.
//
// If the extension doesn't include any parameter in the response, this function
// returns %NULL.
func (x *WebsocketExtension) GetResponseParams() string {

	cret := xWebsocketExtensionGetResponseParams(x.GoPointer())
	return cret
}

var xWebsocketExtensionProcessIncomingMessage func(uintptr, byte, *glib.Bytes, **glib.Error) *glib.Bytes

// Process a message after it's received.
//
// If the payload isn't changed the given @payload is just returned, otherwise
// [method@GLib.Bytes.unref] is called on the given @payload and a new
// [struct@GLib.Bytes] is returned with the new data.
//
// Extensions using reserved bits of the header will reset them in @header.
func (x *WebsocketExtension) ProcessIncomingMessage(HeaderVar byte, PayloadVar *glib.Bytes) (*glib.Bytes, error) {
	var cerr *glib.Error

	cret := xWebsocketExtensionProcessIncomingMessage(x.GoPointer(), HeaderVar, PayloadVar, &cerr)
	if cerr == nil {
		return cret, nil
	}
	return cret, cerr

}

var xWebsocketExtensionProcessOutgoingMessage func(uintptr, byte, *glib.Bytes, **glib.Error) *glib.Bytes

// Process a message before it's sent.
//
// If the payload isn't changed the given @payload is just returned, otherwise
// [method@Glib.Bytes.unref] is called on the given @payload and a new
// [struct@GLib.Bytes] is returned with the new data.
//
// Extensions using reserved bits of the header will change them in @header.
func (x *WebsocketExtension) ProcessOutgoingMessage(HeaderVar byte, PayloadVar *glib.Bytes) (*glib.Bytes, error) {
	var cerr *glib.Error

	cret := xWebsocketExtensionProcessOutgoingMessage(x.GoPointer(), HeaderVar, PayloadVar, &cerr)
	if cerr == nil {
		return cret, nil
	}
	return cret, cerr

}

func (c *WebsocketExtension) GoPointer() uintptr {
	if c == nil {
		return 0
	}
	return c.Ptr
}

func (c *WebsocketExtension) SetGoPointer(ptr uintptr) {
	c.Ptr = ptr
}

func init() {
	core.SetPackageName("SOUP", "libsoup-3.0")
	core.SetSharedLibraries("SOUP", []string{"libsoup-3.0.so.0"})
	var libs []uintptr
	for _, libPath := range core.GetPaths("SOUP") {
		lib, err := purego.Dlopen(libPath, purego.RTLD_NOW|purego.RTLD_GLOBAL)
		if err != nil {
			panic(err)
		}
		libs = append(libs, lib)
	}

	core.PuregoSafeRegister(&xWebsocketExtensionGLibType, libs, "soup_websocket_extension_get_type")

	core.PuregoSafeRegister(&xWebsocketExtensionConfigure, libs, "soup_websocket_extension_configure")
	core.PuregoSafeRegister(&xWebsocketExtensionGetRequestParams, libs, "soup_websocket_extension_get_request_params")
	core.PuregoSafeRegister(&xWebsocketExtensionGetResponseParams, libs, "soup_websocket_extension_get_response_params")
	core.PuregoSafeRegister(&xWebsocketExtensionProcessIncomingMessage, libs, "soup_websocket_extension_process_incoming_message")
	core.PuregoSafeRegister(&xWebsocketExtensionProcessOutgoingMessage, libs, "soup_websocket_extension_process_outgoing_message")

}
