// Package webkit was automatically generated by github.com/jwijenbergh/puregotk DO NOT EDIT
package webkit

import (
	"structs"
	"unsafe"

	"github.com/jwijenbergh/purego"
	"github.com/jwijenbergh/puregotk/pkg/core"
	"github.com/jwijenbergh/puregotk/v4/gdk"
	"github.com/jwijenbergh/puregotk/v4/gio"
	"github.com/jwijenbergh/puregotk/v4/glib"
	"github.com/jwijenbergh/puregotk/v4/gobject"
	"github.com/jwijenbergh/puregotk/v4/gobject/types"
)

type FaviconDatabaseClass struct {
	_ structs.HostLayout

	ParentClass gobject.ObjectClass
}

func (x *FaviconDatabaseClass) GoPointer() uintptr {
	return uintptr(unsafe.Pointer(x))
}

// Enum values used to denote the various errors related to the #WebKitFaviconDatabase.
type FaviconDatabaseError int

var xFaviconDatabaseErrorGLibType func() types.GType

func FaviconDatabaseErrorGLibType() types.GType {
	return xFaviconDatabaseErrorGLibType()
}

const (

	// The #WebKitFaviconDatabase is closed
	FaviconDatabaseErrorNotInitializedValue FaviconDatabaseError = 0
	// There is not an icon available for the requested URL
	FaviconDatabaseErrorFaviconNotFoundValue FaviconDatabaseError = 1
	// There might be an icon for the requested URL, but its data is unknown at the moment
	FaviconDatabaseErrorFaviconUnknownValue FaviconDatabaseError = 2
)

var xFaviconDatabaseErrorQuark func() glib.Quark

// Gets the quark for the domain of favicon database errors.
func FaviconDatabaseErrorQuark() glib.Quark {

	cret := xFaviconDatabaseErrorQuark()
	return cret
}

// Provides access to the icons associated with web sites.
//
// WebKit will automatically look for available icons in &lt;link&gt;
// elements on opened pages as well as an existing favicon.ico and
// load the images found into a memory cache if possible. That cache
// is frozen to an on-disk database for persistence.
//
// If #WebKitSettings:enable-private-browsing is %TRUE, new icons
// won't be added to the on-disk database and no existing icons will
// be deleted from it. Nevertheless, WebKit will still store them in
// the in-memory cache during the current execution.
type FaviconDatabase struct {
	gobject.Object
}

var xFaviconDatabaseGLibType func() types.GType

func FaviconDatabaseGLibType() types.GType {
	return xFaviconDatabaseGLibType()
}

func FaviconDatabaseNewFromInternalPtr(ptr uintptr) *FaviconDatabase {
	cls := &FaviconDatabase{}
	cls.Ptr = ptr
	return cls
}

var xFaviconDatabaseClear func(uintptr)

// Clears all icons from the database.
func (x *FaviconDatabase) Clear() {

	xFaviconDatabaseClear(x.GoPointer())

}

var xFaviconDatabaseGetFavicon func(uintptr, string, uintptr, uintptr, uintptr)

// Asynchronously obtains a favicon image.
//
// Asynchronously obtains an image of the favicon for the
// given page URI. It returns the cached icon if it's in the database
// asynchronously waiting for the icon to be read from the database.
//
// This is an asynchronous method. When the operation is finished, callback will
// be invoked. You can then call webkit_favicon_database_get_favicon_finish()
// to get the result of the operation.
func (x *FaviconDatabase) GetFavicon(PageUriVar string, CancellableVar *gio.Cancellable, CallbackVar *gio.AsyncReadyCallback, UserDataVar uintptr) {

	var CallbackVarRef uintptr
	if CallbackVar != nil {
		CallbackVarPtr := uintptr(unsafe.Pointer(CallbackVar))
		if cbRefPtr, ok := glib.GetCallback(CallbackVarPtr); ok {
			CallbackVarRef = cbRefPtr
		} else {
			fcb := func(arg0 uintptr, arg1 uintptr, arg2 uintptr) {
				cbFn := *CallbackVar
				cbFn(arg0, arg1, arg2)
			}
			CallbackVarRef = purego.NewCallback(fcb)
			glib.SaveCallback(CallbackVarPtr, CallbackVarRef)
		}
	}

	xFaviconDatabaseGetFavicon(x.GoPointer(), PageUriVar, CancellableVar.GoPointer(), CallbackVarRef, UserDataVar)

}

var xFaviconDatabaseGetFaviconFinish func(uintptr, uintptr, **glib.Error) uintptr

// Finishes an operation started with webkit_favicon_database_get_favicon().
func (x *FaviconDatabase) GetFaviconFinish(ResultVar gio.AsyncResult) (*gdk.Texture, error) {
	var cls *gdk.Texture
	var cerr *glib.Error

	cret := xFaviconDatabaseGetFaviconFinish(x.GoPointer(), ResultVar.GoPointer(), &cerr)

	if cret == 0 {
		return nil, cerr
	}
	cls = &gdk.Texture{}
	cls.Ptr = cret
	if cerr == nil {
		return cls, nil
	}
	return cls, cerr

}

var xFaviconDatabaseGetFaviconUri func(uintptr, string) string

// Obtains the URI of the favicon for the given @page_uri.
func (x *FaviconDatabase) GetFaviconUri(PageUriVar string) string {

	cret := xFaviconDatabaseGetFaviconUri(x.GoPointer(), PageUriVar)
	return cret
}

func (c *FaviconDatabase) GoPointer() uintptr {
	if c == nil {
		return 0
	}
	return c.Ptr
}

func (c *FaviconDatabase) SetGoPointer(ptr uintptr) {
	c.Ptr = ptr
}

// This signal is emitted when the favicon URI of @page_uri has
// been changed to @favicon_uri in the database. You can connect
// to this signal and call webkit_favicon_database_get_favicon()
// to get the favicon. If you are interested in the favicon of a
// #WebKitWebView it's easier to use the #WebKitWebView:favicon
// property. See webkit_web_view_get_favicon() for more details.
func (x *FaviconDatabase) ConnectFaviconChanged(cb *func(FaviconDatabase, string, string)) uint32 {
	cbPtr := uintptr(unsafe.Pointer(cb))
	if cbRefPtr, ok := glib.GetCallback(cbPtr); ok {
		return gobject.SignalConnect(x.GoPointer(), "favicon-changed", cbRefPtr)
	}

	fcb := func(clsPtr uintptr, PageUriVarp string, FaviconUriVarp string) {
		fa := FaviconDatabase{}
		fa.Ptr = clsPtr
		cbFn := *cb

		cbFn(fa, PageUriVarp, FaviconUriVarp)

	}
	cbRefPtr := purego.NewCallback(fcb)
	glib.SaveCallback(cbPtr, cbRefPtr)
	return gobject.SignalConnect(x.GoPointer(), "favicon-changed", cbRefPtr)
}

func init() {
	core.SetPackageName("WEBKIT", "webkitgtk-6.0")
	core.SetSharedLibraries("WEBKIT", []string{"libwebkitgtk-6.0.so.4", "libjavascriptcoregtk-6.0.so.1"})
	var libs []uintptr
	for _, libPath := range core.GetPaths("WEBKIT") {
		lib, err := purego.Dlopen(libPath, purego.RTLD_NOW|purego.RTLD_GLOBAL)
		if err != nil {
			panic(err)
		}
		libs = append(libs, lib)
	}

	core.PuregoSafeRegister(&xFaviconDatabaseErrorGLibType, libs, "webkit_favicon_database_error_get_type")

	core.PuregoSafeRegister(&xFaviconDatabaseErrorQuark, libs, "webkit_favicon_database_error_quark")

	core.PuregoSafeRegister(&xFaviconDatabaseGLibType, libs, "webkit_favicon_database_get_type")

	core.PuregoSafeRegister(&xFaviconDatabaseClear, libs, "webkit_favicon_database_clear")
	core.PuregoSafeRegister(&xFaviconDatabaseGetFavicon, libs, "webkit_favicon_database_get_favicon")
	core.PuregoSafeRegister(&xFaviconDatabaseGetFaviconFinish, libs, "webkit_favicon_database_get_favicon_finish")
	core.PuregoSafeRegister(&xFaviconDatabaseGetFaviconUri, libs, "webkit_favicon_database_get_favicon_uri")

}
