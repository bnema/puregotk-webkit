// Package webkit was automatically generated by github.com/jwijenbergh/puregotk DO NOT EDIT
package webkit

import (
	"structs"
	"unsafe"

	"github.com/jwijenbergh/purego"
	"github.com/jwijenbergh/puregotk/pkg/core"
	"github.com/jwijenbergh/puregotk/v4/gdk"
	"github.com/jwijenbergh/puregotk/v4/glib"
	"github.com/jwijenbergh/puregotk/v4/gobject"
	"github.com/jwijenbergh/puregotk/v4/gobject/types"
)

type OptionMenuClass struct {
	_ structs.HostLayout

	ParentClass gobject.ObjectClass
}

func (x *OptionMenuClass) GoPointer() uintptr {
	return uintptr(unsafe.Pointer(x))
}

// Represents the dropdown menu of a `select` element in a #WebKitWebView.
//
// When a select element in a #WebKitWebView needs to display a dropdown menu, the signal
// #WebKitWebView::show-option-menu is emitted, providing a WebKitOptionMenu with the
// #WebKitOptionMenuItem&lt;!-- --&gt;s that should be displayed.
type OptionMenu struct {
	gobject.Object
}

var xOptionMenuGLibType func() types.GType

func OptionMenuGLibType() types.GType {
	return xOptionMenuGLibType()
}

func OptionMenuNewFromInternalPtr(ptr uintptr) *OptionMenu {
	cls := &OptionMenu{}
	cls.Ptr = ptr
	return cls
}

var xOptionMenuActivateItem func(uintptr, uint)

// Activates the #WebKitOptionMenuItem at @index in @menu.
//
// Activating an item changes the value
// of the element making the item the active one. You are expected to close the menu with
// webkit_option_menu_close() after activating an item, calling this function again will have no
// effect.
func (x *OptionMenu) ActivateItem(IndexVar uint) {

	xOptionMenuActivateItem(x.GoPointer(), IndexVar)

}

var xOptionMenuClose func(uintptr)

// Request to close a #WebKitOptionMenu.
//
// This emits WebKitOptionMenu::close signal.
// This function should always be called to notify WebKit that the associated
// menu has been closed. If the menu is closed and neither webkit_option_menu_select_item()
// nor webkit_option_menu_activate_item() have been called, the element value remains
// unchanged.
func (x *OptionMenu) Close() {

	xOptionMenuClose(x.GoPointer())

}

var xOptionMenuGetEvent func(uintptr) uintptr

// Gets the #GdkEvent that triggered the dropdown menu.
// If @menu was not triggered by a user interaction, like a mouse click,
// %NULL is returned.
func (x *OptionMenu) GetEvent() *gdk.Event {
	var cls *gdk.Event

	cret := xOptionMenuGetEvent(x.GoPointer())

	if cret == 0 {
		return nil
	}
	gobject.IncreaseRef(cret)
	cls = &gdk.Event{}
	cls.Ptr = cret
	return cls
}

var xOptionMenuGetItem func(uintptr, uint) *OptionMenuItem

// Returns the #WebKitOptionMenuItem at @index in @menu.
func (x *OptionMenu) GetItem(IndexVar uint) *OptionMenuItem {

	cret := xOptionMenuGetItem(x.GoPointer(), IndexVar)
	return cret
}

var xOptionMenuGetNItems func(uintptr) uint

// Gets the length of the @menu.
func (x *OptionMenu) GetNItems() uint {

	cret := xOptionMenuGetNItems(x.GoPointer())
	return cret
}

var xOptionMenuSelectItem func(uintptr, uint)

// Selects the #WebKitOptionMenuItem at @index in @menu.
//
// Selecting an item changes the
// text shown by the combo button, but it doesn't change the value of the element. You need to
// explicitly activate the item with webkit_option_menu_select_item() or close the menu with
// webkit_option_menu_close() in which case the currently selected item will be activated.
func (x *OptionMenu) SelectItem(IndexVar uint) {

	xOptionMenuSelectItem(x.GoPointer(), IndexVar)

}

func (c *OptionMenu) GoPointer() uintptr {
	if c == nil {
		return 0
	}
	return c.Ptr
}

func (c *OptionMenu) SetGoPointer(ptr uintptr) {
	c.Ptr = ptr
}

// Emitted when closing a #WebKitOptionMenu is requested. This can happen
// when the user explicitly calls webkit_option_menu_close() or when the
// element is detached from the current page.
func (x *OptionMenu) ConnectClose(cb *func(OptionMenu)) uint {
	cbPtr := uintptr(unsafe.Pointer(cb))
	if cbRefPtr, ok := glib.GetCallback(cbPtr); ok {
		handlerID := gobject.SignalConnect(x.GoPointer(), "close", cbRefPtr)
		glib.SaveHandlerMapping(handlerID, cbPtr)
		return handlerID
	}

	fcb := func(clsPtr uintptr) {
		fa := OptionMenu{}
		fa.Ptr = clsPtr
		cbFn := *cb

		cbFn(fa)

	}
	cbRefPtr := purego.NewCallback(fcb)
	glib.SaveCallbackWithClosure(cbPtr, cbRefPtr, cb)
	handlerID := gobject.SignalConnect(x.GoPointer(), "close", cbRefPtr)
	glib.SaveHandlerMapping(handlerID, cbPtr)
	return handlerID
}

func init() {
	core.SetPackageName("WEBKIT", "webkitgtk-6.0")
	core.SetSharedLibraries("WEBKIT", []string{"libwebkitgtk-6.0.so.4", "libjavascriptcoregtk-6.0.so.1"})
	var libs []uintptr
	for _, libPath := range core.GetPaths("WEBKIT") {
		lib, err := purego.Dlopen(libPath, purego.RTLD_NOW|purego.RTLD_GLOBAL)
		if err != nil {
			panic(err)
		}
		libs = append(libs, lib)
	}

	core.PuregoSafeRegister(&xOptionMenuGLibType, libs, "webkit_option_menu_get_type")

	core.PuregoSafeRegister(&xOptionMenuActivateItem, libs, "webkit_option_menu_activate_item")
	core.PuregoSafeRegister(&xOptionMenuClose, libs, "webkit_option_menu_close")
	core.PuregoSafeRegister(&xOptionMenuGetEvent, libs, "webkit_option_menu_get_event")
	core.PuregoSafeRegister(&xOptionMenuGetItem, libs, "webkit_option_menu_get_item")
	core.PuregoSafeRegister(&xOptionMenuGetNItems, libs, "webkit_option_menu_get_n_items")
	core.PuregoSafeRegister(&xOptionMenuSelectItem, libs, "webkit_option_menu_select_item")

}
